\begin{defi}[\acl{PN}]
  A \acf{PN} \PN is a weighted oriented bipartite graph, whose the two subsets of vertices define a tuple \PT where:
  \begin{itemize}
    \item $P$ is a finite set of places,
    \item $T$ is a finite set of transitions.
  \end{itemize}
  For each transition $t \in T$ are defined (exactly) these two functions:
  \begin{itemize}
    \item $I_t : P \mapsto \mathbb{N}$ associates to each place the weight of the edge to $t$ \emph{(input weight)},
    \item $O_t : P \mapsto \mathbb{N}$ associates to each place the weight of the edge from $t$ \emph{(output weight)}.
  \end{itemize}
  It is denoted by $t = \langle I_t, O_t \rangle$.
  Because these functions define the edges of the graph, a \ac{PN} is completely defined by the tuple \PT and so is denoted by \NPT.
\end{defi}

\begin{defi}[marking]
  Given a set of place $P$, a marking of $P$ is a function $\mar : P \mapsto \mathbb{N}$ that associates $\mar(p)$ tokens to each place $p \in P$.
\end{defi}

An order on the markings is essential for the analysis of \acp{PN}. The order we will define is a well quasi-order and a partial order.

\begin{defi}[quasi-order]
  A quasi-order on a set $\mathcal{E}$ is a binary relation $R$ that is:
  \begin{align*}
    \text{reflexive: } &&\forall x \in \mathcal{E},\ & x \mathrel{R} x \\
    \text{transitive: } &&\forall (x, y, z) \in \mathcal{E}^3,\ & (x \mathrel{R} y\land y \mathrel{R} z)\Rightarrow x \mathrel{R} z
  \end{align*}
\end{defi}

\begin{defi}[well quasi-order]
  A well quasi-order $\sqsubseteq$ on a set $\mathcal{E}$ is a quasi-order on $\mathcal{E}$ such that, for any infinite sequence $s = e_0, e_1, e_2, \dots$ of elements from $\mathcal{E}$, there exist indices $i < j$ with $e_i \sqsubseteq e_j$. That is, there is no infinite antichain in $\mathcal{E}$ for this relation.
\end{defi}

\begin{defi}[partial order]
  A partial order on a set $\mathcal{E}$ is a quasi-order $R$ that is
  \begin{align*}
    \text{antisymmetric: } &&\forall (x, y) \in \mathcal{E}^2,\ & (x \mathrel{R} y\land y \mathrel{R} x)\Rightarrow x = y
  \end{align*}
\end{defi}

\begin{defi}[partial order \(\preceq\) on the markings]
  Given a set of places $P$, the partial order \(\preceq \subseteq \mathbb{N}^{|P|} \times \mathbb{N}^{|P|}\) is such that for all pair of markings \((\mar_1, \mar_2) \in \mathbb{N}^{|P|} \times \mathbb{N}^{|P|}\) we have that \(\mar_1 \preceq \mar_2\) if and only if for all place \(p \in P : \mar_1(p) \leq \mar_2(p)\).
\end{defi}

\(\mar \prec \marp\) denotes that \(\mar \preceq \marp \text{ and } \marp \npreceq \mar\).

\begin{lemm}[\cite{Dickson13}]
  \label{lemm:wqo}
  $\preceq$ is a well quasi-order.
\end{lemm}

The following result will be useful in the sequel.

\begin{lemm}[\cite{Brams83}]
  The \ac{PN} model is \emph{strongly monotonic with regard to $\preceq$}. That is, for all \ac{PN} $\PN = \PTm$, for all transition $t \in T$ and for all markings $\mar_1, \mar_2, \mar_3$ of \PN such that $\mar_1 \preceq \mar_2$ and $\mar_1 \fire{t} \mar_3$, there exists a marking $\mar_4$ of \PN such that $\mar_2 \fire{t} \mar_4$ and $\mar_3 \preceq \mar_4$.
\end{lemm}

In this work we will focus on an extension of the \ac{PN} model, the \ac{PPN} model, that is extended thanks to the use of parameters as input and output weights.

\begin{defi}[\acl{PPN} \citep{David17}]
  A \acf{PPN} \SPTP is a weighted oriented bipartite graph with a finite set $\mathbb{P}$ of parameters. The two subsets of vertices are:
  \begin{itemize}
    \item $P$: a finite set of places,
    \item $T$: a finite set of transitions,
  \end{itemize}
  For each transition $t \in T$ are defined the following functions:
  \begin{itemize}
    \item $I_t : P \mapsto \mathbb{N} \cup \mathbb{P}$ associates to each place the weight of the edge to $t$ \emph{(input weight)},
    \item $O_t : P \mapsto \mathbb{N} \cup \mathbb{P}$ associates to each place the weight of the edge from $t$ \emph{(output weight)}.
  \end{itemize}
\end{defi}

As for plain \acp{PN}, this is denoted $t = \langle I_t, O_t \rangle$.

\begin{defi}[parametric marking]
  Given a set of place $P$, a parametric marking of $P$ is a function $\mar : P \mapsto \mathbb{N} \cup \mathbb{P} $ that associates $\mar(p)$ tokens to each place $p \in P$.
\end{defi}

A marking of a \ac{PN} \NPT is a marking of $P$.
A marking of a \ac{PPN} \SPTP is a \emph{parametric} marking of $P$.
Note that a marking \mar is a parametric marking where $\mar(p) \in \mathbb{N}$ for all $p \in P$.

More generally, given a set

\begin{defi}[initialized (parametric) \ac{PN}]
  An initialized \ac{PN} \NPTm (resp. \ac{PPN} \SPTPm) is a \ac{PN} (resp. \ac{PPN}) with an initial marking \mari.
\end{defi}

This is sometimes called a \emph{marked (parametric) \ac{PN}}.
We will often refer to an initialized (parametric) \ac{PN} loosely as a (parametric) \ac{PN}.

The figure~\ref{fig:parametric-petri-net-example} shows an example of \ac{PPN} whose $\mathbb{P} = \{a, b\}$ and with an initial marking \mari such that $\mari(p_1) = 1$, $\mari(p_2) = a$ and $\mari(p_3) = 0$. The circles represent the places, the rectangles are the transitions, and the dots are the tokens. If the number of token at a given place is parametric (\lang{i.e.} depends on a parameter of $\mathbb{P}$), it is written inside the circle. An arrow from a place $p$ and to a transition $t$ denotes that $I_t(p) = 1$. The absence of an arrow from $p$ to $t$ indicates that $I_t(p) = 0$. If $I_t(p) \notin \{0, 1\}$, a label with the value of $I_t(p)$ is added to the arrow.
Symmetrically, the arrows from the transitions to the places indicate the output weights.

\begin{figure}[h]
  \centering
  \include{res/parametric-petri-net-example}
  \par
  \caption{An initialized \ac{PPN}}
  \label{fig:parametric-petri-net-example}
\end{figure}

We usually set an order on the places.
This allows to view the markings as vectors (here, \mari is the column vector $(1, a, 0)^T$, where $\cdot^T$ is the transpose operator) as well as the $I$ and $O$ functions.
Likewise, we define an order on the transitions.
Therefore, $I_t$ and $O_t$ denote respectively the $I$ and $O$ functions defined for the $t$\textsuperscript{th} transition (here, $I_1 = (0, 0, 0)^T$ and $O_1 = (b, 0, 0)^T$).
Given a \ac{PPN} \SPTP, the backward and forward incidence matrices $\matIS \in (\mathbb{N} \cup \mathbb{P})^{|P|\times|T|}$ and $\matOS \in (\mathbb{N} \cup \mathbb{P})^{|P|\times|T|}$ are naturally defined by $\matIS(p, t) = I_t(p)$ and $\matOS(p, t) = O_t(p)$.
($\PPN$ is omitted when it is obvious from the context.)
%In addition, it makes the equivalence between \acp{PN} and \emph{vector addition systems} introduced in \cite{Karp69} more explicit and
This allows to use linear algebra to analyse \acp{PN}.

\begin{figure}[h]
	\[
		\matI = \bordermatrix[{[]}]{%
					& t_1 & t_2 & t_3 \cr
			p_1 & 0   & 1   & 0   \cr
			p_2 & 0   & 1   & 0   \cr
			p_3 & 0   & 0   & 1   }
		\mspace{56mu}
		\matO = \bordermatrix[{[]}]{%
					& t_1 & t_2 & t_3 \cr
			p_1 & b   & 0   & 0   \cr
			p_2 & 0   & 0   & 1   \cr
			p_3 & 0   & 1   & 0   }
	\]
  \caption{The incidence matrices of the \ac{PN} from figure \ref{fig:parametric-petri-net-example}}
  \label{fig:incidence-matrices-example}
\end{figure}

%\begin{defi}[Vector addition system]
%  A vector addition system of dimension $n$ is a pair $\langle d, W\rangle$ where $d \in \mathbb{N}^n$ is called the \emph{start vector} and $W$ is a finite set of vector $\mathbb{Z}^n$.
%\end{defi}
%This corresponds to the definition of an initialized \ac{PN} and \todo{we will see that the semantic corresponds too}.

\subsection{Operational semantic of \acp{PN}}

Given a \ac{PN} \NPT and a marking \mar on \PN, a transition $t \in T$ is said \emph{enabled} by \mar if $\forall p \in P : \mar(p) \geq I_t(p)$. An enabled transition can be \emph{fired} to produce a new marking \marp such that $\forall p \in P : \marp(p) = \mar(p) - I_t(p) + O_t(p)$. This is denoted by $\mar \fire{t} \marp$.
It is important to note that the effect of a transition is to add or remove a constant number of tokens at each place and does not depend on the marking from which it is fired. A \ac{PN} transition is said to have a \emph{constant effect}.

Here are some additional notations:
\begin{itemize}
  \item $\mar \rightarrow \marp$ denotes that there exists $t \in T$ such that $\mar \fire{t} \marp$.
  \item $\mar \fire{\sigma} \marp$ where $\sigma$ is a sequence of transitions $\sigma = (t_1, \dots, t_{n-1}), t_i \in T, i \in \{1, \dots, n-1\}$ denotes that there exists a sequence of markings $\mar_1, \dots, \mar_n$ such that : $\mar = \mar_1 \fire{t_1} \cdots \fire{t_{n-1}} \mar_n = \marp$.
  \item $\mar \fire{*} \marp$ denotes that there exists a sequence of transition $\sigma$ such that $\mar \fire{\sigma} \marp$.
    Note that the $\fire{*}$ relation is the reflexive and transitive closure of the relation $\rightarrow$.
\end{itemize}

\begin{defi}
  Given an \ac{PN} \NPT and a marking \mar of \PN:
  \begin{itemize}
    \item $\Post(\mar) = \{\marp \mid \mar \rightarrow \marp\}$ is the set of one-step successors of \mar,
    \item $\Pre(\mar) = \{\marp \mid \marp \rightarrow \mar\}$ is the set of one-step predecessors of \mar,
    \item $\Post^*(\mar) = \{\marp \mid \mar \fire{*} \marp\}$ is the set of successors of \mar, in any number of step.
      With $\mari$ the initial marking of \PN, $\Post^*(\mari)$ is the \emph{reachability set} of \PN.
    \item $\Pre^*(\mar) = \{\marp \mid \marp \fire{*} \mar\}$ is the set of predecessors of \mar, in any number of step.
  \end{itemize}
\end{defi}

These operators are naturally extended to sets of markings as the union of the sets obtained by applying the operator on each marking of the sets.
That is, with $M$ a set of markings of \PN,
$\Post(M) = \{\marp \mid \exists \mar \in M : \mar \rightarrow \marp\}$.

For example, regarding the \ac{PPN} shown on figure \ref{fig:parametric-petri-net-example},
$\Post((0,1,0)) = \{(b, 1, 0)\}$
and
$\Post^*((0,1,0)) = \{(i, 1, 0) \mid i \in \mathbb{N}\} \cup \{(i, 0, 1) \mid i \in \mathbb{N}\}$.

All of this applies to \ac{PPN} through valuations of the parameters:
\begin{defi}[Instantiation of \acp{PPN}]
  Let \SPTPm be a \ac{PPN} and $v : \mathbb{P} \mapsto \mathbb{N}$ be a \emph{$\mathbb{N}$-valuation}, or simply valuation, on $\mathbb{P}$.
  Then $v(\PPN)$ is defined as the \ac{PN} obtained by replacing each parameter $a \in \mathbb{P}$ by $v(a)$.
  Thus, we have $v(\PPN) = \langle P, T, \marpi\rangle$ such that :
  \begin{itemize}
    \item $\matI_{v(\PPN)}(p, t) =
      \begin{cases}
        \phantom{v(}\matIS(p, t) & \text{if } \matIS(p, t) \in \mathbb{N} \\
                 v(\matIS(p, t)) & \text{if } \matIS(p, t) \in \mathbb{P}
      \end{cases}$
    \item $\matO_{v(\PPN)}(p, t) =
      \begin{cases}
        \phantom{v(}\matOS(p, t) & \text{if } \matOS(p, t) \in \mathbb{N} \\
                 v(\matOS(p, t)) & \text{if } \matOS(p, t) \in \mathbb{P}
      \end{cases}$
    \item $\marpi(p) =
      \begin{cases}
        \phantom{v(}\mari(p) & \text{if } \mari(p) \in \mathbb{N} \\
                 v(\mari(p)) & \text{if } \mari(p) \in \mathbb{P}
      \end{cases}$
  \end{itemize}
\end{defi}

Given \PPN a \ac{PPN} and a valuation $v$, one can thus instantiate a \ac{PN} $v(\PPN)$ from \PPN and apply the semantic described above.  When the \ac{PPN} under consideration is clear from the context, $\matI_v$ is used to denote $\matI_{v(\PPN)}$ and $\matO_v$ to denote $\matO_{v(\PPN)}$. We write $\firev{t}$, $\rightarrow_v$, $\firev{\sigma}$, $\firev{*}$, $\Post_v$, $\Pre_v$, $\Post^*_v$ and $\Pre^*_v$ to denote $\fire{t}$, $\rightarrow$, $\fire{\sigma}$, $\fire{*}$, $\Post$, $\Pre$, $\Post^*$ and $\Pre^*$ on the plain \ac{PN} $v(\PPN)$.

This makes it possible to formally represent a system and interactions between its components. We will now define some properties that the model may have and that are usually of interest to show that the modelled system meets some requirements.

\subsection{Behavioural properties of \acp{PN}}

The markings basically indicate the state of the system. Thus, knowing if an initialized \ac{PN} may reach a given marking, that represents for example a bad state, is essential to check properties of the modelled system. This is the \emph{reachability problem}.

\begin{defi}[Reachability]
  Given an initialized \ac{PN} \NPTm and a marking \mar of \PN, \mar is said reachable if $\mari \fire{*} \mar$.
\end{defi}

However, the verification of safety properties are more often reduced to a \emph{coverability problem}, that is essentially asking if a \ac{PN} can reach or exceed a given marking.

\begin{restatable}[Coverability]{defi}{coverability}
  Given an initialized \ac{PN} \NPTm and a marking \mar of \PN, \mar is said coverable if there exists a marking \marp such that $\mar \preceq \marp$ and $\mari \fire{*} \marp$.

  A set of markings is said coverable whenever one of them is coverable.
\end{restatable}

\begin{defi}[Coverability problem]
  Given an initialized \ac{PN} \NPTm and a set $M$ of markings of \PN, determine whether $\exists \mar \in M \text{ and } \marp \in \Post^*(\mari) \text{ such that } \mar \preceq \marp$.

  The coverability problem for a marking \mar is the coverability problem for the singleton $\{\mar\}$.
\end{defi}

The behaviour of a \ac{PPN} is defined by the behaviours of all the \acp{PN} that can be obtained by a valuation of its parameters.
So, for an initialized \ac{PPN} \PPN, the coverability problem may be declined in an existential and an universal form.
The existential coverability problem (\Ecov) ask if there exists a valuation $v$ such that \mar is coverable.
The universal coverability problem (\Ucov) ask if \mar is coverable for all valuations $v$.

\begin{defi}[Universal and existential coverability problems]
  Given a \ac{PPN} \SPTPm and a set $M$ of non-parametric markings of \PPN
  \begin{itemize}
    \item the \emph{existential coverability problem} ask if there is a valuation $v$ for $\mathbb{P}$ such that $M$ is coverable,
    \item the \emph{universal   coverability problem} ask if $M$ is coverable for all valuations of $\mathbb{P}$.
  \end{itemize}
\end{defi}


% vim: spell spelllang=en :
